<IfModule mod_ssl.c>
<VirtualHost *:443>
	ServerName      angeomlive.math.msu.ru
        ServerAlias     angeomlive.math.msu.su

        ErrorLog ${APACHE_LOG_DIR}/angeomlive.math.msu.ru-error.log
        CustomLog ${APACHE_LOG_DIR}/angeomlive.math.msu.ru-access.log combined

	RewriteEngine on
	RewriteCond %{SERVER_NAME} =angeomlive.math.msu.su
	RewriteRule ^ https://angeomlive.math.msu.ru%{REQUEST_URI} [END,NE,R=permanent]

        Define   SRVDIR /var/www/angeomlive.math.msu.ru
        Define   PROJECTNAME mathtask

        <Directory ${SRVDIR}/mathtask>
        <Files wsgi.py>
                Require all granted
        </Files>
        </Directory>

        WSGIDaemonProcess mathtask  python-home=${SRVDIR}/env-mathtask python-path=${SRVDIR}
        WSGIProcessGroup mathtask
        WSGIScriptAlias / ${SRVDIR}/mathtask/wsgi.py

        Alias /static/ ${SRVDIR}/static/
        <Directory ${SRVDIR}/static>
           Order deny,allow
           Allow from all
        </Directory>

        Alias /media/ ${SRVDIR}/media/
        <Directory ${SRVDIR}/media>
           Order deny,allow
           Allow from all
        </Directory>




	SSLCertificateFile /etc/letsencrypt/live/angeomlive.math.msu.ru/fullchain.pem
	SSLCertificateKeyFile /etc/letsencrypt/live/angeomlive.math.msu.ru/privkey.pem
	Include /etc/letsencrypt/options-ssl-apache.conf
</VirtualHost>
</IfModule>
